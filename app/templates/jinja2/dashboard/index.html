{% from "components/card.html" import card %}
{% extends "dashboard/base.html" %}

{% block title %}Dashboard{% endblock %}

{% block pagetitle %}My Dashboard{% endblock %}
{% block pagesubtitle %}Welcome, {{ request.user.get_full_name() }}{% endblock %}

{% block subcontent %}
{% if game.is_signups %}
  {% if not participant %}
    <div class="alert alert-warning show">
      You haven't signed up for the {{ game }} game.If you wish to join,
    <a href="{{ url('game_signup') }}">you can sign up here</a>.
    </div>
  {% else %}
    <div class="alert alert-success show">
      You're signed up for the {{ game }} game! {% if participant.is_player %} Your code is: {{ participant.code }}.{% endif %}
    </div>
  {% endif %}
{% endif %}

<div class="ui-grid s-dashboard__game-info align-content-start">
  <div class="ui-grid align-content-start">
  
    {% if not game.is_finished and participant.is_player and participant.user.legacy_points() %}
    {% call card("Legacy Tokens") %}
    
    {% if points_accu < points_for_permanent %}
      <p>You currently have {{ participant.user.legacy_points() }} tokens available to use! You have accumulated {{ points_accu }} tokens total and need {{ points_for_permanent - points_accu }} more tokens to achieve legacy status. You may use a legacy token to start a game either as OZ or with 15 points. If you use a token, you gain acccess to the volunteer mission.</p>
      {% if participant.is_oz or participant.point_modifier >= 15 %}
      <p>You are either already an OZ or have 15 points to start with.</p>
      {% else %}
      {% if game.is_running %}<p>The game has already started, but you can still use legacy tokens to gain 15 points</p>{% endif %}
      <table><tr>
      {% if not game.is_running %}
      <td scope="col">
      <form class="mb-0" action="{{ url('dashboard') }}" method="post">
          {{ csrf_input }}
          <input type="submit" class="btn btn-normal" value="Start as OZ" name="oz">
        </form></td>
      {% endif %}
        <td scope="col">
      <form class="mb-0" action="{{ url('dashboard') }}" method="post">
          {{ csrf_input }}
          <input type="submit" class="btn btn-normal" value="Start with 15 Points" name="pts">
        </form></td>
      </tr></table>
      {% endif %}
    {% else %}
      <p>You have succesfully achieved Legacy Status! You may request to be OZ or receive 15 starting points every game prior to every game start! You will always have volunteer mission access when you choose to use these perks!</p>
      {% if participant.is_oz or participant.score() >= 15 %}
      <p>You are either already an OZ or have 15 points to start with.</p>
      {% else %}
      <table><tr>
      <td scope="col">
      <form class="mb-0" action="{{ url('dashboard') }}" method="post">
          {{ csrf_input }}
          <input type="submit" class="btn btn-normal" value="Start as OZ" name="oz">
        </form></td>
        <td scope="col">
      <form class="mb-0" action="{{ url('dashboard') }}" method="post">
          {{ csrf_input }}
          <input type="submit" class="btn btn-normal" value="Start with 15 Points" name="pts">
        </form></td>
      </tr></table>
      {% endif %}
    {% endif %}
    
    {% endcall %}
    {% endif %}
    
{% if game.is_signups %} {% call card("Welcome to the game!") %}
<p>The game will begin on Friday, September 17 @ 4:00 PM, and runs 24 hours a day until the end of final mission on Sunday, September 19 @ 5:00 PM. If you have any friends who have never played before and would like to join, please tell them to sign up via our website. We’ve designed this game to be beginner-friendly, so any word-of-mouth advertising is greatly appreciated!</p> 
<p>We understand that there will likely be concerns around player safety, given the nature of gameplay. Below, please find the modifications made to the game in response to COVID-19. </p>
<ul>
    <li><strong>All players MUST be vaccinated.</strong> Following the University of Waterloo’s COVID-19 protocols, all students, staff, alumni and campus visitors MUST submit proof of vaccination prior to entering campus. Please be sure to submit your proof of vaccination here: <a href="https://uwaterloo.ca/coronavirus/news/submit-your-proof-vaccination-today">https://uwaterloo.ca/coronavirus/news/submit-your-proof-vaccination-today</a></li>
    <li><strong>Mandating face coverings while playing.</strong> Yes, even when you’re outside. Face coverings should be covering your nose, mouth, and chin. Bandanas are not acceptable face coverings.</li>
    <li><strong>Outdoor mission objectives.</strong> All mission objectives are placed outside for the weekendlong, and missions will be designed to use as much of campus as possible.</li>
    <li><strong>Recommending all players to maintain physical distancing as much as possible.</strong> Again, we can’t control what you do. But we ask you to consider physical distancing with other players wherever possible.</li>
    <li><strong>Requiring a COVID-19 self-assessment prior to gameplay.</strong> The first time you sign into the website, you will be greeted with a screen asking you to complete the Ontario COVID-19 self-assessment.</li>
</ul>
<p>If you have any signs or symptoms of COVID-19, DO NOT PLAY. </p>
<p><strong>Please also note that there are some changes in rules from our typical weeklong. These changes are listed below:</strong></p>
<ul>
    <li>Buildings are no longer safe between 10:00AM - 4:00PM. Permanent safe zones (e.g. libraries, food establishments, washrooms, Student Life Centre - see the Rules for the full list) remain safe. Events being held on-campus are considered safe for the duration of the event plus 5 minutes before and after the official start and end time, respectively.</li>
    <li>Removal of the infected human mechanic.</li>
    <li>Removal of the unsupplied human mechanic.</li>
    <li>Removal of rail and building passes as potential point rewards.</li>
    <li>Addition of sightseeing passes as potential point rewards. </li>
</ul>
<p>At 3:00 PM on Friday, September 17th, you will receive an email indicating whether you are beginning the game as a HUMAN or a ZOMBIE. This email will also include information relevant for the entire weekendlong, so make sure you’re checking your inbox!</p> 
<p>Throughout the game, the moderator team will be communicating to you primarily through email. Each night, an email will be sent out including the schedule and events for the next day. Main mission details will be sent out in a separate email one hour before the main mission begins.  Additional important information will also be sent over twitter through @HVZAlertSystem, which can conveniently be found right here!</p>
<p> If you need to rent a blaster from the Humans vs Zombie Society for use in the weeklong, you can email us at uwhumansvszombies@gmail.com for more information.</p>
{% endcall %} {% endif %}

{% call card("System Requirements") %}
      <p>Currently, this website is fully supported by <b>Chrome</b>, <b>Firefox</b>, and <b>Microsoft Edge</b>. If you are not using one of these browsers, you may experience some technical issues.</p>
    {% endcall %}
  </div>
  <div class="ui-grid align-content-start">
    {% call card() %}
      <a class="twitter-timeline" height="500" href="https://twitter.com/HVZAlertSystem?ref_src=twsrc%5Etfw">Tweets by HVZAlertSystem</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    {% endcall %}
    
    {% call card("Lifetime Stats") %}
      <p>Total Stuns: {{ stuns }}</p>
      <p>Total Kills: {{ kills }}</p>
      <p>Total Supply Codes Redeemed: {{ codes }}</p>
    {% endcall %}
  </div>
</div>
{% endblock %}
